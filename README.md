# API Petrovich (Автосклонение русских ФИО)

## Установка

- склонировать репозиторий
- установить зависимости `np install`
- при необходимости создаь файл .env и прописать в нем порт `PORT=...`
- запустить `npm run start`

## Использование

1. Можно обращаться к API напрямую.
   В этот случае в теле передаем объект

```
{
  fio: "Иванов Сергей Иванович",
  case_fio: 1
}
```

fio - ФИО. Допускается использование русских букв (включя ё), тире и пробелов

case_fio - [опциоальное] падеж. Целое число от 1 до 6 (если не задан по умолчанию родительный)

- 1 - именительный (кто? что?)
- 2 - родительный (кого? чего?)
- 3 - дательный (кому? чему?)
- 4 - винительный (кого? что?)
- 5 - творительный (кем? чем?)
- 6 - предложный (о ком? о чем?)

## Использование в MS Excel

- Открыть редактор макросов `Alt + F11`
- Нажать правую кнопку на корневом элементе и в контекстном меню выбрать `Insert -> Module`
- Скопировать содержимое файла в открывшееся окно
- Сохранить

После этого можно пользоваться функиий СКЛОНФИО(ФИО;Падеж)

## Предупреждения

А этом случае возвращается неизменненное ФИО с добавленным

- '[ПАДЕЖ?]' - падеж задан цифрой отличной от указанного выше диапазона
- '[ПОЛ?]' - невозможно определить пол и, соответственно, выполнить склонение

## Ошибки

- '#НЕТДАННЫХ' - в поле fio данных
- '#ОШИБКАРУС' - в поле fio присутствуют символы отличные от допустимых
- '#ОШИБКАФИО' - поле fio состоит не из трех слов (составная фамилия и дефисом считается одним словом)
